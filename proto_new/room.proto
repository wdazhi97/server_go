syntax = "proto3";

package room_service;
option go_package = "./proto_new";

import "proto_new/common.proto";

// 房间服务
service RoomService {
  // 创建房间
  rpc CreateRoom(CreateRoomRequest) returns (CreateRoomResponse);
  // 加入房间
  rpc JoinRoom(JoinRoomRequest) returns (JoinRoomResponse);
  // 离开房间
  rpc LeaveRoom(LeaveRoomRequest) returns (LeaveRoomResponse);
  // 发送消息
  rpc SendMessage(SendMessageRequest) returns (SendMessageResponse);
  // 获取房间消息
  rpc GetRoomMessages(GetRoomMessagesRequest) returns (GetRoomMessagesResponse);
  // 开始游戏
  rpc StartGame(StartGameRequest) returns (StartGameResponse);
}

// 房间服务消息
message CreateRoomRequest {
  string user_id = 1;
  string room_name = 2;
  int32 max_players = 3;
}

message CreateRoomResponse {
  bool success = 1;
  string message = 2;
  string room_id = 3;
}

message JoinRoomRequest {
  string room_id = 1;
  string user_id = 2;
}

message JoinRoomResponse {
  bool success = 1;
  string message = 2;
}

message LeaveRoomRequest {
  string room_id = 1;
  string user_id = 2;
}

message LeaveRoomResponse {
  bool success = 1;
  string message = 2;
}

message SendMessageRequest {
  string room_id = 1;
  string sender_id = 2;
  string content = 3;
  string type = 4; // text, system, etc.
}

message SendMessageResponse {
  bool success = 1;
  string message = 2;
}

message GetRoomMessagesRequest {
  string room_id = 1;
  int32 limit = 2;
  int64 since = 3;
}

message GetRoomMessagesResponse {
  bool success = 1;
  string message = 2;
  repeated common.Message messages = 3;
}

message StartGameRequest {
  string room_id = 1;
}

message StartGameResponse {
  bool success = 1;
  string message = 2;
}